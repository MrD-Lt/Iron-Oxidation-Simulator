Now the manual input part has fewer bugs.